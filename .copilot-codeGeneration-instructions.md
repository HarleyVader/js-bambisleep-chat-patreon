# BambiSleep Chat Code Generation Guidelines

## IMPORTANT: CORE FUNCTIONALITY PRESERVATION

**THE CORE PATREON OAUTH2 INTEGRATION IS STABLE AND WORKING AS OF MAY 2, 2025**

- DO NOT modify the existing OAuth2 authentication flow
- DO NOT change the token exchange or refresh mechanisms
- DO NOT alter the patron verification logic
- DO NOT modify the database schema or core data structure
- DO NOT change the existing API endpoint contracts

Future changes should EXTEND functionality without breaking existing implementations.

## Overall Style

- Write minimalist, straightforward code that prioritizes simplicity over edge cases
- Functions should do one thing and be as short as possible
- Favor direct solutions over "best practices" when they add complexity
- Use existing patterns found in the codebase rather than introducing new ones

## Formatting and Documentation

- Use brief, single-line comments explaining logic rather than extensive documentation
- Keep code lines short and readable
- Only document complex logic that isn't immediately obvious
- No JSDoc style comments unless absolutely necessary

## Functionality

- Provide the simplest implementation that solves the immediate problem
- Don't add error handling for unlikely edge cases
- Assume happy path execution in most cases
- Reuse existing utility functions rather than creating new ones

## Specific Patterns

- Use plain JavaScript over complex abstractions or frameworks
- Follow the existing CSS naming conventions and color variables
- Use direct DOM manipulation instead of complex frameworks
- Prefer simple event listeners and callbacks

## Variables and Functions

- Use meaningful but concise variable and function names
- Keep function parameter counts low (1-3 parameters when possible)
- Avoid complex destructuring unless it significantly simplifies code
- Prefer named functions over anonymous arrow functions for main functionality

## Avoid

- Over-engineering solutions
- Extensive error handling for unlikely scenarios
- Complex abstractions that hide simple operations
- Adding dependencies unless absolutely necessary
- Deep nesting of functions or callbacks

## Patreon APIv2 OAuth2 Implementation

- Always include required fields explicitly in API requests (APIv2 returns minimal data by default)
- Use basic URLSearchParams for building request parameters
- Include User-Agent header to prevent 403 errors
- Keep OAuth scopes minimal - only request what's absolutely needed
- Use simple object structures for API responses rather than custom classes
- Store tokens as plain objects without complex encryption (rely on HTTPS)
- Implement the simplest possible token refresh mechanism
- Use direct attribute access for member status checking
- Skip extensive validation for API responses
- Avoid complex caching mechanisms unless absolutely necessary
- Implement minimal error handling for API communication